---
title: 이미지 프로세싱 & 컴퓨터 시각화 2부
---

안녕하세요. 지난시간에 우리는 이미지 프로세싱과 컴퓨터 시각화가 무엇인지 간략히 살펴보았으며 응용분야에 대해서도 짚어보았습니다. 2부 부터는 우리들도 기본기를 한번 다져보죠! 멋지지 않습니까?

꽤 긴 여정이 될 수도 있지만 그 긴 여정의 끝은 말로 다 형언할 수 없는 뿌듯함이 존재할꺼에요. 고진감래라는 옛말 기억하시죠? :)

여기서 저는 Python3를 사용할 것이며 Jupyter Notebook이라는 IDE를 가지고 코딩을 진행할 꺼에요. Jupyter Notebook이 뭔지 처음 들어보시는 분들도 계시겠지만 여기서 장황한 설명은 생략할께요^^ 검색하시면 아실꺼에요. 

그리고 중요한 package 하나가 필요합니다. 바로 *opencv*라는 녀석입니다. 혹시라도 설치가 되어 있지 않다면 주저마시고 바로 설치를 해주세요. 그래야 저와 함께 여행을 하실 수 있으니깐요.

그럼 우리는 준비가 완료되었습니다. Jupyter Notebook을 실행하고 새로운 workspace를 하나 생성할께요. 다음과 같군요. 아무것도 없습니다. 당연하죠~ 우리는 여기다 코딩을 시작할 꺼에요.

![empty_work](/emerald/img/empty_work.png "empty_work")  

[1] Library 로드
다른 언어와 마찬가지로 파이썬도 수많은 페키지/라이브러리들을 제공합니다. 이것들을 import하여 우리의 작업공간에서 마음껏 사용할 수 있죠. 또한 무료이기 때문에 참 좋죠?
다음과 같은 페키지들을 기본적으로 불러옵니다 (아마 끝날때까지 제네들은 거의 계속 불러올 예정이에요)

> import numpy as np
> import cv
> import matplotlib.pyplot as plt
> %matplotlib inline

numpy는 파이썬에서 array형태의 데이터를 좀 더 효율적으로 많은 연산과 형태 변환 기능을 가능케 해주며 cv는 opencv페키지입니다. opencv2라고 해서 cv2로 불러오는 실수는 하지 마세요^^ matplotlib은 workspace에 이미지를 보여줄때 많이 쓰입니다. 물론 seaborn이라는 훌륭한 녀석도 존재하지만 저는 matplotlib을 쓸께요. 혹시나 모르는 분들이 계실까봐 노파심에서 부연설명을 아주 짧게 할께요. import할때 as라는 키워드를 쓰는데 페키지 이름이 너무 길경우 as(ALIAS)로 축약하여 사용할 수 있습니다. 

맨 마지막 녀석 %matplotlib inline은 생소한 분들도 계시겠지만 저건 import하는것이 아닙니다. 이걸 넣어줘야 우리는 이미지를 작업공간에서 바로 볼 수 있습니다. 그렇지 않으면 우리는 

> <matplotlib.figure.Figure at 0x110b9c450>

이런 수수께끼스러운 문구를 우리들에게 보여주며 이미지는 보여주지 않는 삐뚤어지는 행동을 합니다. 따라서 이미지를 보기 위해선 %matplotlib inline를 실행시켜줘야 합니다~

자 그럼 돌립니다.  
 
![import](/emerald/img/import.png "Gray")

만약 아무런 에러가 없이 정상적으로 페키지들을 불러왔다면 우리는 아무런 에러메세지를 접하지 않을 꺼에요. 지금까지는 준비단계였어요. 이제부터 본격적으로 opencv에 대한 설명을 해야겠군요.

opencv란 직접 웹사이트에 가서 긁어왔습니다. 영문이니 참고하세요. 자세한 정보는 직접 웹사이트에 방문하시면 되겠네요. (https://opencv.org/)
> OpenCV (Open Source Computer Vision Library) is released under a BSD license and hence it’s free for both academic and commercial use. It has C++, Python and Java interfaces and supports Windows, Linux, Mac OS, iOS and Android. OpenCV was designed for computational efficiency and with a strong focus on real-time applications. Written in optimized C/C++, the library can take advantage of multi-core processing. Enabled with OpenCL, it can take advantage of the hardware acceleration of the underlying heterogeneous compute platform.
  
그럼 저의 관점에서 설명해 볼께요. opencv는 파이썬을 포함함 몇가지 프로그래밍 언어를 사용하여 이미지 프로세싱과 컴퓨터 시각화를 다룰때 필수불가결한 페키지입니다. 마치 문을 열기 위해서 우리는 무조건 맞는 키를 사용해야만 문을 열 수 있듯이 우리는 원하는 목적을 이루기 위해서 opencv라는 페키지를 사용해야 합니다. 

![open_key](/emerald/img/open_key.png "Face_Rec")


[1] 얼굴 인식 (Face Recognition)

우리가 휴대폰으로 사람들의 사진을 찍을때 얼굴부분에 정사각형 표시가 나오는 현상 기억하시나요? 아니면 페이스북을 사용하시다가 누군가를 태그할때 얼굴부분이 자동으로 인식되어서 이미지에 표기되는 현상 기억하시나요? 이런 것들을 흔히 얼굴 인식이라고 합니다. 이미지 프로세싱을 포함한 컴퓨터 시각화를 통해 훈련된 기계가 사람들의 얼굴을 귀신같이 찾아냅니다 (나중에 좀 더 자세히 다루도록 할께요 왜냐하면 서두가 길어지면 피곤하겠죠?)

![Face_Rec](/emerald/img/face_recog.png "Face_Rec")

[2] 차선 인식 (Lane Detection)

자율주행 (Automonous Vehicle)이라고 들어보셨죠? 어떻게 만들어지는지는 몰라도 됩니다. 무지하게 복잡한 과정을 거치고 수많은 학습과 훈련을 통해 자기가 스스로 주행하는 자동차인것이죠. 그러나 최근에 테슬라와 다양한 회사에서 테스트를 시도하다 인명사고가 난 뉴스를 많이 접했습니다. 그러곤 깨달았죠. 아직 갈길이 멀었다는 것을.. 하지만 언젠가는 자율주행 자동차가 보급화 되어서 택시기사들의 일자리를 앗아갈 수도 있겠군요..라는 생각이 듭니다. 흠....

자, 여담은 그만하고 자율주행을 할 때 차선인식을 함으로써 차가 직진해야 할지 턴을 해야 할지 알아야겠죠? 우리도 운전을 할 때 차선을 보고 판단하듯이 자동차도 똑같이 합니다. 차선을 구분하는 방법을 여기서 설명하기에는 너무 많은 설명이 필요한지라 그냥 이미지 프로세싱을 통해 얻을 수 있는 결과물 중 하나구나 하고 넘기시면 되겠네요 :) 차선을 감지하면 감지된 부분으로 자동차가 주행하겠군요.

![Lane_det](/emerald/img/lane_detection.png "Lane_det")

그림에서 나타나듯 차선을 감지하고 감지된 영역을 표기하여 저 부분을 이탈하면 안된다는 것을 기계는 무한한 학습을 통하여 배우는 것이죠.

[3] 폐결절 감지 (Lung Nodule Detection) 

제가 석사과정을 밟으면서 했던 프로젝트가 생각이 납니다. 예전에 어떤 기관으로부터 동의하에 수많은 환자들의 X-Ray, MRI사진을 통하여 분류기를 생성하고 이 분류기가 하는 역할은 단순한 이미지를 보고 폐결절이 있는지 아닌지를 판별하는 것이죠. 여기서도 이미지 프로세싱 작업은 매우 중추적인 역할을 합니다. 하지만 사람들의 생사가 달린 문제라 손가락을 바들바들 떨면서 코딩을 했던 기억이.... 그래도 사람 생명에 지장은 없었습니다^^ 왜냐면 제가 만든 학습기가 실제 적용된건 아니구 단지 개발 단계였으니까요.

제목에 폐결절 감지라고 적어놨는데 그럼 폐결절만 감지하는 것인가? 하고 질문하시는 분이 계실 수도 있을까요? 자자!! 폐결절 감지 뿐만 아니라 다양한 병명을 거미줄처럼 복잡하게 얽혀진 이미지 프로세싱과 딥러닝 등 다양한 기숟들을 동원해 감지할 수 있습니다. 따라서 우리들은 의사들의 판단에 100% 의존하는 것이 아니라 사람이 미처 보지 못한 부분들을 기계가 감지하여 같이 결론을 낸다면 더욱 훌륭한 진단이 나오지 않을까요? (물론 기계가 아주 훈련을 잘 받았고 어마어마한 데이타를 근거하여 학습을 했다는 가정에서 말입니다) 

![Nodule](/emerald/img/nodule.png "Nodule")

위의 사진처럼 저렇게 관심영역(Region of Interest)을 표기해주며 저 부분이 Lung Nodule로 얼마만큼의 확률로 자신있어 하는지 저의 분류기는 알려줍니다. 만약 그릇된 결과를 생성한다면 이는 잘못 학습된 것이므로 생성기를 다시 때려고쳐야 했습니다 (파라미터값을 변경하거나 더 많은 이미지를 동원하여 학습을 시키거나 등등...)


자자.. 여기까지 나열할께요. 응용분야를 나열하자니 밤샐것 같네요. 정말 많네요!! 컴퓨터 시각화는 매우 흥미로우며 앞으로도 전망이 큰 분야라고 저는 굳게 믿습니다! 제가 위에 열거하지 않은 수많은 응용분야가 있지요. 그럼 다음 시간에는 이미지 프로세싱의 기본부터 한번 다져볼까요?^^ 시작이 반이라고 여러분은 이미 반을 마치셨습니다? 언젠가는 우리들도 이미지를 자유자재로 다룰 수 있는 날이 올 것입니다!!

